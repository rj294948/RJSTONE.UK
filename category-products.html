<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StoneCraft UK | Premium Stone Products</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== GLOBAL STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* ===== SLIM HEADER ===== */
        header {
            background-color: #ffffff;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            height: 70px; /* Slim height */
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
            padding: 0 10px;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo h1 {
            font-size: 24px;
            color: #333;
            font-weight: 700;
        }
        
        .logo span {
            color: #b8860b;
        }
        
        /* Search Bar */
        .search-container {
            flex: 1;
            max-width: 500px;
            margin: 0 30px;
        }
        
        .search-input-container {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .search-input {
            width: 100%;
            padding: 10px 45px 10px 20px;
            border: 1px solid #e1e5e9;
            border-radius: 25px;
            font-size: 14px;
            background-color: #f8f9fa;
            transition: all 0.3s;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #b8860b;
            background-color: white;
            box-shadow: 0 0 0 3px rgba(184, 134, 11, 0.1);
        }
        
        .search-button {
            position: absolute;
            right: 8px;
            background: #b8860b;
            color: white;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        
        .search-button:hover {
            background: #a3780a;
        }
        
        /* User Icons */
        .user-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .user-action {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #555;
            font-size: 11px;
            transition: color 0.3s;
        }
        
        .user-action:hover {
            color: #b8860b;
        }
        
        .user-action i {
            font-size: 18px;
            margin-bottom: 3px;
        }
        
        /* ===== MAIN CONTENT ===== */
        .main-content {
            margin-top: 90px;
            padding: 30px 0;
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .page-header h1 {
            font-size: 36px;
            color: #333;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .page-header .breadcrumb {
            color: #666;
            font-size: 16px;
        }
        
        .page-header .breadcrumb a {
            color: #b8860b;
            text-decoration: none;
            font-weight: 500;
        }
        
        .page-header .breadcrumb span {
            margin: 0 8px;
            color: #999;
        }
        
        /* ===== MAIN LAYOUT ===== */
        .main-layout {
            display: flex;
            gap: 30px;
        }
        
        /* ===== PRODUCTS SECTION ===== */
        .products-section {
            flex: 1;
        }
        
        .products-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .products-count {
            font-size: 16px;
            color: #666;
            font-weight: 500;
        }
        
        /* ===== PRODUCT GRID ===== */
        #products-list {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4 products per row on desktop */
            gap: 25px;
        }
        
        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .product-img-box {
            width: 100%;
            height: 220px;
            overflow: hidden;
            position: relative;
        }
        
        .product-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }
        
        .product-card:hover .product-img {
            transform: scale(1.05);
        }
        
        .product-info {
            padding: 18px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .product-description {
            font-size: 15px;
            color: #222;
            font-weight: 500;
            line-height: 1.4;
            margin-bottom: 8px;
            min-height: 42px;
        }
        
        .product-rate {
            font-size: 18px;
            font-weight: 700;
            color: #b8860b;
            margin-bottom: 12px;
        }
        
        .details-btn {
            display: inline-block;
            padding: 10px 16px;
            font-size: 14px;
            background: #b8860b;
            color: white;
            border-radius: 6px;
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
            text-align: center;
            border: none;
            cursor: pointer;
            margin-top: auto;
        }
        
        .details-btn:hover {
            background: #a3780a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(184, 134, 11, 0.3);
        }
        
        /* ===== COMPACT FILTERS SIDEBAR ===== */
        .filters-sidebar {
            flex: 0 0 280px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            height: fit-content;
            position: sticky;
            top: 100px;
        }
        
        .filter-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .filter-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .filter-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .filter-title i {
            color: #b8860b;
            font-size: 16px;
        }
        
        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .filter-option {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px 10px;
            border-radius: 6px;
            transition: background 0.3s;
        }
        
        .filter-option:hover {
            background: #f8f9fa;
        }
        
        .filter-option.active {
            background: #f8f6f0;
        }
        
        .filter-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid #ddd;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .filter-option.active .filter-checkbox {
            background: #b8860b;
            border-color: #b8860b;
        }
        
        .filter-option.active .filter-checkbox::after {
            content: '✓';
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .filter-label {
            font-size: 14px;
            color: #555;
            font-weight: 500;
            flex: 1;
        }
        
        .filter-count {
            background: #f0f0f0;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
            color: #666;
        }
        
        .filter-option.active .filter-label {
            color: #b8860b;
            font-weight: 600;
        }
        
        /* ===== ACTIVE FILTERS ===== */
        .active-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            align-items: center;
        }
        
        .active-filters-title {
            font-weight: 600;
            color: #333;
            margin-right: 10px;
            font-size: 14px;
        }
        
        .active-filter {
            background: #e9ecef;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }
        
        .remove-filter {
            cursor: pointer;
            color: #666;
            font-size: 14px;
            transition: color 0.3s;
        }
        
        .remove-filter:hover {
            color: #dc3545;
        }
        
        .clear-all-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            margin-left: auto;
            transition: background 0.3s;
        }
        
        .clear-all-btn:hover {
            background: #c82333;
        }
        
        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            #products-list {
                grid-template-columns: repeat(3, 1fr); /* 3 products per row on smaller desktop */
            }
        }
        
        @media (max-width: 992px) {
            .main-layout {
                flex-direction: column;
            }
            
            .filters-sidebar {
                flex: none;
                width: 100%;
                position: static;
            }
            
            #products-list {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-wrap: wrap;
                height: auto;
                padding: 10px;
            }
            
            .logo {
                order: 1;
            }
            
            .search-container {
                order: 3;
                flex-basis: 100%;
                margin: 10px 0 0;
                max-width: 100%;
            }
            
            .user-actions {
                order: 2;
            }
            
            .main-content {
                margin-top: 110px;
            }
            
            #products-list {
                grid-template-columns: repeat(2, 1fr); /* 2 products per row on tablet */
            }
            
            .product-img-box {
                height: 200px;
            }
        }
        
        @media (max-width: 576px) {
            #products-list {
                grid-template-columns: 1fr; /* 1 product per row on mobile */
            }
            
            .product-img-box {
                height: 250px;
            }
            
            .user-action span {
                display: none;
            }
            
            .user-actions {
                gap: 15px;
            }
        }
        
        /* ===== NO PRODUCTS STATE ===== */
        .no-products {
            text-align: center;
            padding: 60px 20px;
            grid-column: 1 / -1;
        }
        
        .no-products i {
            font-size: 64px;
            color: #ddd;
            margin-bottom: 20px;
        }
        
        .no-products h3 {
            font-size: 24px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .no-products p {
            color: #888;
            margin-bottom: 20px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <!-- ===== SLIM HEADER ===== -->
    <header>
        <div class="container">
            <div class="header-content">
                <!-- Logo -->
                <div class="logo">
                    <h1>Stone<span>Craft</span></h1>
                </div>
                
                <!-- Search Bar -->
                <div class="search-container">
                    <div class="search-input-container">
                        <input type="text" class="search-input" id="searchInput" placeholder="Search for stones, products...">
                        <button class="search-button" id="searchButton">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
                
                <!-- User Icons -->
                <div class="user-actions">
                    <a href="#" class="user-action">
                        <i class="fas fa-user"></i>
                        <span>Account</span>
                    </a>
                    <a href="#" class="user-action">
                        <i class="fas fa-heart"></i>
                        <span>Wishlist</span>
                    </a>
                    <a href="#" class="user-action">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Cart (0)</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- ===== MAIN CONTENT ===== -->
    <div class="main-content">
        <div class="container">
            <!-- Page Header -->
            <div class="page-header">
                <h1>Premium Stone Collection</h1>
                <div class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span>></span>
                    <span>Products</span>
                </div>
            </div>
            
            <!-- Active Filters Display -->
            <div class="active-filters" id="activeFilters" style="display: none;">
                <span class="active-filters-title">Active Filters:</span>
                <!-- Active filters will show here -->
            </div>
            
            <!-- Main Layout with Products and Filters -->
            <div class="main-layout">
                <!-- Products Section -->
                <div class="products-section">
                    <div class="products-header">
                        <div class="products-count" id="productsCount">
                            Loading products...
                        </div>
                    </div>
                    
                    <!-- Product Grid -->
                    <div id="products-list">
                        <!-- Products will be dynamically loaded here -->
                    </div>
                </div>
                
                <!-- Compact Filters Sidebar -->
                <div class="filters-sidebar">
                    <!-- Categories Filter -->
                    <div class="filter-section">
                        <h3 class="filter-title">
                            <i class="fas fa-layer-group"></i>
                            Categories
                        </h3>
                        <div class="filter-options" id="categoryFilters">
                            <!-- Categories will be dynamically loaded here -->
                        </div>
                    </div>
                    
                    <!-- Stone Types Filter -->
                    <div class="filter-section">
                        <h3 class="filter-title">
                            <i class="fas fa-gem"></i>
                            Stone Types
                        </h3>
                        <div class="filter-options" id="stoneTypeFilters">
                            <!-- Stone types will be dynamically loaded here -->
                        </div>
                    </div>
                    
                    <!-- Colors Filter -->
                    <div class="filter-section">
                        <h3 class="filter-title">
                            <i class="fas fa-palette"></i>
                            Colors
                        </h3>
                        <div class="filter-options" id="colorFilters">
                            <!-- Colors will be dynamically loaded here -->
                        </div>
                    </div>
                    
                    <!-- Usage Filter -->
                    <div class="filter-section">
                        <h3 class="filter-title">
                            <i class="fas fa-home"></i>
                            Usage
                        </h3>
                        <div class="filter-options" id="usageFilters">
                            <!-- Usage options will be dynamically loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== PRODUCT DATA =====
        const productsData = [
            {
                id: 1,
                name: "Carrara Marble",
                description: "Premium white marble with subtle grey veins",
                price: 125,
                category: "Marble",
                stoneType: "Marble",
                color: "White",
                usage: "Flooring",
                image: "https://images.unsplash.com/photo-1586023492125-27b2c045efd7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 2,
                name: "Black Galaxy Granite",
                description: "Luxury black granite with gold speckles",
                price: 95,
                category: "Granite",
                stoneType: "Granite",
                color: "Black",
                usage: "Countertops",
                image: "https://images.unsplash.com/photo-1595428774223-ef52624120d2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 3,
                name: "Kashmir Gold Granite",
                description: "Warm golden granite with brown patterns",
                price: 110,
                category: "Granite",
                stoneType: "Granite",
                color: "Gold",
                usage: "Flooring",
                image: "https://images.unsplash.com/photo-1611273426858-450d8e3c9fce?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 4,
                name: "Travertine Classic",
                description: "Natural travertine with earthy tones",
                price: 85,
                category: "Travertine",
                stoneType: "Limestone",
                color: "Beige",
                usage: "Wall Cladding",
                image: "https://images.unsplash.com/photo-1541140532154-b024d705b90a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 5,
                name: "Blue Pearl Granite",
                description: "Stunning blue granite with silver flecks",
                price: 140,
                category: "Granite",
                stoneType: "Granite",
                color: "Blue",
                usage: "Countertops",
                image: "https://images.unsplash.com/photo-1516937941344-00b4e0337589?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 6,
                name: "Calacatta Gold Marble",
                description: "Luxurious white marble with gold veins",
                price: 180,
                category: "Marble",
                stoneType: "Marble",
                color: "White",
                usage: "Bathroom",
                image: "https://images.unsplash.com/photo-1586023492125-27b2c045efd7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 7,
                name: "Red Sandstone",
                description: "Natural red sandstone with rich texture",
                price: 75,
                category: "Sandstone",
                stoneType: "Sandstone",
                color: "Red",
                usage: "Outdoor",
                image: "https://images.unsplash.com/photo-1541140532154-b024d705b90a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 8,
                name: "Slate Grey",
                description: "Durable slate with charcoal grey finish",
                price: 65,
                category: "Slate",
                stoneType: "Slate",
                color: "Grey",
                usage: "Flooring",
                image: "https://images.unsplash.com/photo-1611273426858-450d8e3c9fce?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 9,
                name: "Emerald Pearl Granite",
                description: "Green granite with pearl-like patterns",
                price: 120,
                category: "Granite",
                stoneType: "Granite",
                color: "Green",
                usage: "Countertops",
                image: "https://images.unsplash.com/photo-1595428774223-ef52624120d2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 10,
                name: "Botticino Marble",
                description: "Classic Italian marble with warm tones",
                price: 135,
                category: "Marble",
                stoneType: "Marble",
                color: "Beige",
                usage: "Flooring",
                image: "https://images.unsplash.com/photo-1586023492125-27b2c045efd7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 11,
                name: "Limestone Cream",
                description: "Soft cream limestone with natural texture",
                price: 90,
                category: "Limestone",
                stoneType: "Limestone",
                color: "Cream",
                usage: "Wall Cladding",
                image: "https://images.unsplash.com/photo-1541140532154-b024d705b90a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            },
            {
                id: 12,
                name: "Absolute Black Granite",
                description: "Deep black granite with mirror finish",
                price: 150,
                category: "Granite",
                stoneType: "Granite",
                color: "Black",
                usage: "Countertops",
                image: "https://images.unsplash.com/photo-1595428774223-ef52624120d2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            }
        ];

        // ===== APPLICATION STATE =====
        const appState = {
            products: productsData,
            filteredProducts: productsData,
            filters: {
                categories: [],
                stoneTypes: [],
                colors: [],
                usage: []
            },
            searchQuery: ''
        };

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
            initializeSearch();
        });

        // ===== PAGE INITIALIZATION =====
        function initializePage() {
            displayProducts();
            generateFilters();
            updateProductsCount();
        }

        // ===== PRODUCT DISPLAY =====
        function displayProducts() {
            const productsContainer = document.getElementById("products-list");
            
            if (!appState.filteredProducts.length) {
                productsContainer.innerHTML = `
                    <div class="no-products">
                        <i class="fas fa-search"></i>
                        <h3>No Products Found</h3>
                        <p>Try adjusting your filters or search terms</p>
                    </div>
                `;
                return;
            }

            productsContainer.innerHTML = appState.filteredProducts.map(product => `
                <div class="product-card">
                    <div class="product-img-box">
                        <img src="${product.image}" alt="${product.name}" class="product-img">
                    </div>
                    <div class="product-info">
                        <p class="product-description">${product.description}</p>
                        <p class="product-rate">£${product.price}</p>
                        <a href="#" class="details-btn">View Details</a>
                    </div>
                </div>
            `).join('');
        }

        // ===== FILTER GENERATION =====
        function generateFilters() {
            generateCategoryFilters();
            generateStoneTypeFilters();
            generateColorFilters();
            generateUsageFilters();
        }

        function generateCategoryFilters() {
            const container = document.getElementById('categoryFilters');
            const categories = [...new Set(appState.products.map(p => p.category))];
            
            container.innerHTML = categories.map(category => {
                const count = appState.products.filter(p => p.category === category).length;
                const isActive = appState.filters.categories.includes(category);
                
                return `
                    <div class="filter-option ${isActive ? 'active' : ''}" data-filter="category" data-value="${category}">
                        <div class="filter-checkbox"></div>
                        <span class="filter-label">${category}</span>
                        <span class="filter-count">${count}</span>
                    </div>
                `;
            }).join('');
            
            // Add event listeners
            container.querySelectorAll('.filter-option').forEach(option => {
                option.addEventListener('click', function() {
                    const filterType = this.getAttribute('data-filter');
                    const value = this.getAttribute('data-value');
                    toggleFilter(filterType, value);
                });
            });
        }

        function generateStoneTypeFilters() {
            const container = document.getElementById('stoneTypeFilters');
            const stoneTypes = [...new Set(appState.products.map(p => p.stoneType))];
            
            container.innerHTML = stoneTypes.map(stoneType => {
                const count = appState.products.filter(p => p.stoneType === stoneType).length;
                const isActive = appState.filters.stoneTypes.includes(stoneType);
                
                return `
                    <div class="filter-option ${isActive ? 'active' : ''}" data-filter="stoneType" data-value="${stoneType}">
                        <div class="filter-checkbox"></div>
                        <span class="filter-label">${stoneType}</span>
                        <span class="filter-count">${count}</span>
                    </div>
                `;
            }).join('');
            
            // Add event listeners
            container.querySelectorAll('.filter-option').forEach(option => {
                option.addEventListener('click', function() {
                    const filterType = this.getAttribute('data-filter');
                    const value = this.getAttribute('data-value');
                    toggleFilter(filterType, value);
                });
            });
        }

        function generateColorFilters() {
            const container = document.getElementById('colorFilters');
            const colors = [...new Set(appState.products.map(p => p.color))];
            
            container.innerHTML = colors.map(color => {
                const count = appState.products.filter(p => p.color === color).length;
                const isActive = appState.filters.colors.includes(color);
                
                return `
                    <div class="filter-option ${isActive ? 'active' : ''}" data-filter="colors" data-value="${color}">
                        <div class="filter-checkbox"></div>
                        <span class="filter-label">${color}</span>
                        <span class="filter-count">${count}</span>
                    </div>
                `;
            }).join('');
            
            // Add event listeners
            container.querySelectorAll('.filter-option').forEach(option => {
                option.addEventListener('click', function() {
                    const filterType = this.getAttribute('data-filter');
                    const value = this.getAttribute('data-value');
                    toggleFilter(filterType, value);
                });
            });
        }

        function generateUsageFilters() {
            const container = document.getElementById('usageFilters');
            const usageOptions = [...new Set(appState.products.map(p => p.usage))];
            
            container.innerHTML = usageOptions.map(usage => {
                const count = appState.products.filter(p => p.usage === usage).length;
                const isActive = appState.filters.usage.includes(usage);
                
                return `
                    <div class="filter-option ${isActive ? 'active' : ''}" data-filter="usage" data-value="${usage}">
                        <div class="filter-checkbox"></div>
                        <span class="filter-label">${usage}</span>
                        <span class="filter-count">${count}</span>
                    </div>
                `;
            }).join('');
            
            // Add event listeners
            container.querySelectorAll('.filter-option').forEach(option => {
                option.addEventListener('click', function() {
                    const filterType = this.getAttribute('data-filter');
                    const value = this.getAttribute('data-value');
                    toggleFilter(filterType, value);
                });
            });
        }

        // ===== FILTER LOGIC =====
        function toggleFilter(filterType, value) {
            const filterArray = appState.filters[filterType];
            const index = filterArray.indexOf(value);
            
            if (index > -1) {
                filterArray.splice(index, 1);
            } else {
                filterArray.push(value);
            }
            
            applyFilters();
            updateFilterUI(filterType, value);
            updateActiveFilters();
        }

        function applyFilters() {
            let filtered = [...appState.products];
            
            // Apply category filters
            if (appState.filters.categories.length > 0) {
                filtered = filtered.filter(product => 
                    appState.filters.categories.includes(product.category)
                );
            }
            
            // Apply stone type filters
            if (appState.filters.stoneTypes.length > 0) {
                filtered = filtered.filter(product => 
                    appState.filters.stoneTypes.includes(product.stoneType)
                );
            }
            
            // Apply color filters
            if (appState.filters.colors.length > 0) {
                filtered = filtered.filter(product => 
                    appState.filters.colors.includes(product.color)
                );
            }
            
            // Apply usage filters
            if (appState.filters.usage.length > 0) {
                filtered = filtered.filter(product => 
                    appState.filters.usage.includes(product.usage)
                );
            }
            
            // Apply search query
            if (appState.searchQuery) {
                const query = appState.searchQuery.toLowerCase();
                filtered = filtered.filter(product => 
                    product.name.toLowerCase().includes(query) ||
                    product.description.toLowerCase().includes(query) ||
                    product.category.toLowerCase().includes(query)
                );
            }
            
            appState.filteredProducts = filtered;
            displayProducts();
            updateProductsCount();
        }

        function updateFilterUI(filterType, value) {
            const option = document.querySelector(`[data-filter="${filterType}"][data-value="${value}"]`);
            if (option) {
                const isActive = appState.filters[filterType].includes(value);
                if (isActive) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            }
        }

        // ===== ACTIVE FILTERS DISPLAY =====
        function updateActiveFilters() {
            const activeFiltersContainer = document.getElementById('activeFilters');
            const filters = [];
            
            // Category filters
            appState.filters.categories.forEach(category => {
                filters.push(`
                    <div class="active-filter">
                        Category: ${category}
                        <span class="remove-filter" data-type="categories" data-value="${category}">×</span>
                    </div>
                `);
            });
            
            // Stone type filters
            appState.filters.stoneTypes.forEach(stoneType => {
                filters.push(`
                    <div class="active-filter">
                        Stone: ${stoneType}
                        <span class="remove-filter" data-type="stoneTypes" data-value="${stoneType}">×</span>
                    </div>
                `);
            });
            
            // Color filters
            appState.filters.colors.forEach(color => {
                filters.push(`
                    <div class="active-filter">
                        Color: ${color}
                        <span class="remove-filter" data-type="colors" data-value="${color}">×</span>
                    </div>
                `);
            });
            
            // Usage filters
            appState.filters.usage.forEach(usage => {
                filters.push(`
                    <div class="active-filter">
                        Usage: ${usage}
                        <span class="remove-filter" data-type="usage" data-value="${usage}">×</span>
                    </div>
                `);
            });
            
            if (filters.length > 0) {
                activeFiltersContainer.innerHTML = `
                    <span class="active-filters-title">Active Filters:</span>
                    ${filters.join('')}
                    <button class="clear-all-btn" id="clearAllFilters">Clear All</button>
                `;
                activeFiltersContainer.style.display = 'flex';
                
                // Add remove functionality
                document.querySelectorAll('.remove-filter').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const type = this.getAttribute('data-type');
                        const value = this.getAttribute('data-value');
                        removeFilter(type, value);
                    });
                });
                
                // Add clear all functionality
                document.getElementById('clearAllFilters').addEventListener('click', clearAllFilters);
            } else {
                activeFiltersContainer.style.display = 'none';
            }
        }

        function removeFilter(filterType, value) {
            const filterArray = appState.filters[filterType];
            const index = filterArray.indexOf(value);
            
            if (index > -1) {
                filterArray.splice(index, 1);
                applyFilters();
                updateFilterUI(filterType, value);
                updateActiveFilters();
            }
        }

        function clearAllFilters() {
            appState.filters = {
                categories: [],
                stoneTypes: [],
                colors: [],
                usage: []
            };
            
            applyFilters();
            updateActiveFilters();
            
            // Update all filter options UI
            document.querySelectorAll('.filter-option').forEach(option => {
                option.classList.remove('active');
            });
        }

        // ===== SEARCH FUNCTIONALITY =====
        function initializeSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchButton = document.getElementById('searchButton');
            
            searchButton.addEventListener('click', performSearch);
            searchInput.addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    performSearch();
                }
            });
            
            function performSearch() {
                appState.searchQuery = searchInput.value.trim();
                applyFilters();
            }
        }

        // ===== PRODUCT COUNT UPDATE =====
        function updateProductsCount() {
            const productsCount = document.getElementById('productsCount');
            const totalCount = appState.products.length;
            const filteredCount = appState.filteredProducts.length;
            
            let countText = `Showing ${filteredCount} of ${totalCount} products`;
            
            if (filteredCount < totalCount) {
                countText += ` (${totalCount - filteredCount} hidden by filters)`;
            }
            
            productsCount.textContent = countText;
        }
    </script>
</body>
</html>
