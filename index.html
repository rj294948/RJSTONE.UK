<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IRYA STONE | Premium Sandstone & Kota Stone UK</title>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Slab:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

<style>
:root {
    --primary-gold: #c9a227;
    --gold-light: #f0d77c;
    --gold-dark: #9c7c1f;
    --stone-dark: #1a1a1a;
    --stone-light: #f4f6f4;
    --bg-light: #f7f9fc;
    --text-dark: #222222;
    --text-light: #666666;
    --white: #ffffff;
    --shadow-sm: 0 2px 10px rgba(0,0,0,0.1);
    --shadow-md: 0 4px 15px rgba(0,0,0,0.15);
    --shadow-lg: 0 8px 25px rgba(0,0,0,0.2);
    --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    --border-radius: 16px;
    --border-radius-lg: 24px;
    --border-radius-xl: 32px;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
}

body {
    background: var(--bg-light);
    color: var(--text-dark);
    padding-bottom: 100px;
    font-size: 15px;
    scroll-behavior: smooth;
    -webkit-tap-highlight-color: transparent;
    overscroll-behavior-y: contain;
}

/* App Container */
.app-container {
    max-width: 480px;
    margin: 0 auto;
    background: var(--white);
    box-shadow: 0 0 30px rgba(0,0,0,0.05);
    min-height: 100vh;
    position: relative;
}

/* Header - App Style */
header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, var(--stone-dark) 0%, #2c2c2c 100%);
    padding: 15px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: var(--shadow-md);
    z-index: 1000;
    transform: translateY(0);
    transition: var(--transition);
    border-bottom: 3px solid var(--primary-gold);
}

header.hidden {
    transform: translateY(-100%);
}

.logo {
    display: flex;
    align-items: center;
    gap: 12px;
}

.logo-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--primary-gold), var(--gold-dark));
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--white);
    font-size: 20px;
    box-shadow: 0 4px 12px rgba(201, 162, 39, 0.3);
}

.logo-text {
    display: flex;
    flex-direction: column;
}

.logo-text .brand {
    font-size: 18px;
    font-weight: 700;
    color: var(--white);
    font-family: 'Roboto Slab', serif;
    letter-spacing: 0.5px;
}

.logo-text .tagline {
    font-size: 10px;
    color: var(--gold-light);
    letter-spacing: 1px;
    text-transform: uppercase;
}

/* Smart Search Bar */
.search-container {
    position: fixed;
    top: 80px;
    left: 0;
    right: 0;
    background: var(--white);
    padding: 15px 20px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    z-index: 999;
    transform: translateY(-100%);
    transition: var(--transition);
    border-bottom: 2px solid var(--primary-gold);
}

.search-container.active {
    transform: translateY(0);
}

.smart-search-box {
    display: flex;
    align-items: center;
    gap: 10px;
}

.search-input-container {
    flex: 1;
    position: relative;
}

.search-input-container input {
    width: 100%;
    padding: 16px 50px 16px 20px;
    border-radius: var(--border-radius-xl);
    border: 2px solid #e8e8e8;
    background: var(--bg-light);
    font-size: 16px;
    font-weight: 500;
    transition: var(--transition);
    color: var(--stone-dark);
}

.search-input-container input:focus {
    outline: none;
    border-color: var(--primary-gold);
    background: var(--white);
    box-shadow: 0 0 0 4px rgba(201, 162, 39, 0.15);
}

.search-input-container .search-icon {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--primary-gold);
    font-size: 18px;
}

.search-close {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: var(--stone-dark);
    color: var(--white);
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    cursor: pointer;
    transition: var(--transition);
}

.search-close:hover {
    background: var(--primary-gold);
    transform: rotate(90deg);
}

.search-results {
    margin-top: 15px;
    background: var(--white);
    border-radius: var(--border-radius);
    box-shadow: var(--shadow-lg);
    max-height: 60vh;
    overflow-y: auto;
    display: none;
}

.search-results.active {
    display: block;
}

.search-result-item {
    padding: 16px 20px;
    border-bottom: 1px solid #f5f5f5;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 15px;
}

.search-result-item:hover {
    background: linear-gradient(90deg, rgba(201, 162, 39, 0.05), transparent);
    padding-left: 25px;
}

.search-result-image {
    width: 60px;
    height: 60px;
    border-radius: 12px;
    overflow: hidden;
    background: var(--bg-light);
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid var(--gold-light);
    padding: 2px;
}

.search-result-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 10px;
}

.search-result-info {
    flex: 1;
    min-width: 0;
}

.search-result-name {
    font-size: 15px;
    font-weight: 600;
    color: var(--stone-dark);
    margin-bottom: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.search-result-meta {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 4px;
}

.search-result-category {
    font-size: 12px;
    color: var(--white);
    background: var(--primary-gold);
    padding: 3px 10px;
    border-radius: 20px;
    font-weight: 500;
}

.search-result-usage {
    font-size: 12px;
    color: var(--text-light);
}

.search-result-price {
    font-size: 16px;
    font-weight: 700;
    color: var(--primary-gold);
    font-family: 'Roboto Slab', serif;
}

.no-results {
    padding: 40px 20px;
    text-align: center;
    color: var(--text-light);
}

.no-results i {
    font-size: 48px;
    margin-bottom: 15px;
    opacity: 0.3;
}

/* Header Actions */
.header-actions {
    display: flex;
    align-items: center;
    gap: 12px;
}

.action-btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--white);
    font-size: 18px;
    cursor: pointer;
    transition: var(--transition);
    position: relative;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.action-btn:hover {
    background: var(--primary-gold);
    transform: translateY(-2px);
}

.cart-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background: #ff4757;
    color: var(--white);
    font-size: 11px;
    font-weight: 700;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid var(--stone-dark);
}

/* Hero Section - App Style */
.hero {
    padding: 120px 20px 40px;
    text-align: center;
    position: relative;
    overflow: hidden;
    min-height: 420px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, 
        rgba(26, 26, 26, 0.95) 0%, 
        rgba(44, 44, 44, 0.85) 100%),
        url('https://images.unsplash.com/photo-1544931170-3ca1337cce88?auto=format&fit=crop&w=1200&q=80&blur=20');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
    color: var(--white);
    border-radius: 0 0 var(--border-radius-xl) var(--border-radius-xl);
    margin-bottom: 20px;
}

.hero-content {
    max-width: 400px;
}

.hero h1 {
    font-size: 36px;
    font-weight: 800;
    margin-bottom: 15px;
    font-family: 'Roboto Slab', serif;
    line-height: 1.2;
    text-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.hero p {
    font-size: 16px;
    opacity: 0.9;
    margin-bottom: 30px;
    line-height: 1.6;
    font-weight: 300;
}

.hero-buttons {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    justify-content: center;
}

.hero-btn {
    padding: 16px 30px;
    border-radius: var(--border-radius-xl);
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    min-width: 160px;
    text-decoration: none;
    box-shadow: 0 6px 20px rgba(0,0,0,0.2);
}

.hero-btn.primary {
    background: linear-gradient(135deg, var(--primary-gold), var(--gold-dark));
    color: var(--white);
    border: none;
}

.hero-btn.primary:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 25px rgba(201, 162, 39, 0.4);
}

.hero-btn.secondary {
    background: rgba(255, 255, 255, 0.15);
    color: var(--white);
    border: 2px solid rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.hero-btn.secondary:hover {
    background: rgba(255, 255, 255, 0.25);
    transform: translateY(-5px);
    border-color: var(--primary-gold);
}

/* Quick Actions */
.quick-actions {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 15px;
    padding: 0 20px 25px;
    margin-bottom: 10px;
}

.quick-action {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 15px 10px;
    background: var(--white);
    border-radius: var(--border-radius);
    box-shadow: var(--shadow-sm);
    transition: var(--transition);
    cursor: pointer;
    text-decoration: none;
    color: var(--text-dark);
}

.quick-action:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-md);
    color: var(--primary-gold);
}

.quick-action-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--bg-light), #f0f0f0);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    color: var(--primary-gold);
    transition: var(--transition);
}

.quick-action:hover .quick-action-icon {
    background: linear-gradient(135deg, var(--primary-gold), var(--gold-dark));
    color: var(--white);
    transform: scale(1.1);
}

.quick-action span {
    font-size: 12px;
    font-weight: 600;
    text-align: center;
}

/* Sections */
.section {
    padding: 25px 20px;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.section-header h2 {
    font-size: 22px;
    font-weight: 700;
    color: var(--stone-dark);
    font-family: 'Roboto Slab', serif;
}

.view-all {
    font-size: 14px;
    font-weight: 600;
    color: var(--primary-gold);
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 5px;
}

/* Categories Grid */
.categories-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin-bottom: 10px;
}

.category-card {
    background: var(--white);
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
    transition: var(--transition);
    cursor: pointer;
    text-decoration: none;
    color: inherit;
    display: block;
    position: relative;
    height: 200px;
}

.category-card.featured {
    grid-column: span 2;
    height: 240px;
}

.category-card:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-lg);
}

.category-image {
    width: 100%;
    height: 100%;
    overflow: hidden;
    position: relative;
}

.category-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.category-card:hover .category-image img {
    transform: scale(1.1);
}

.category-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 100%);
    color: white;
    padding: 25px 20px 20px;
}

.category-name {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 5px;
    font-family: 'Roboto Slab', serif;
}

.category-count {
    font-size: 13px;
    opacity: 0.9;
    display: flex;
    align-items: center;
    gap: 5px;
}

/* Uses Grid */
.uses-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
}

.use-card {
    background: var(--white);
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
    transition: var(--transition);
    cursor: pointer;
    text-decoration: none;
    color: inherit;
    display: block;
    position: relative;
    height: 180px;
}

.use-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-md);
}

.use-image {
    width: 100%;
    height: 100%;
    overflow: hidden;
    position: relative;
}

.use-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.6s ease;
}

.use-card:hover .use-image img {
    transform: scale(1.1);
}

.use-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
    color: white;
    padding: 20px 15px 15px;
}

.use-name {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 5px;
    font-family: 'Roboto Slab', serif;
}

/* Featured Products */
.featured-products {
    background: linear-gradient(135deg, var(--bg-light) 0%, #f0f2f5 100%);
    border-radius: var(--border-radius-xl);
    margin: 0 20px 25px;
    padding: 25px 20px;
}

.featured-slider {
    display: flex;
    gap: 15px;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    padding-bottom: 10px;
    -webkit-overflow-scrolling: touch;
}

.featured-slider::-webkit-scrollbar {
    display: none;
}

.featured-slide {
    min-width: 280px;
    scroll-snap-align: start;
}

.featured-product-card {
    background: var(--white);
    border-radius: var(--border-radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-md);
    transition: var(--transition);
    height: 100%;
}

.featured-product-image {
    height: 200px;
    overflow: hidden;
    position: relative;
}

.featured-product-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.6s ease;
}

.featured-product-card:hover .featured-product-image img {
    transform: scale(1.1);
}

.featured-product-badge {
    position: absolute;
    top: 15px;
    left: 15px;
    background: var(--primary-gold);
    color: var(--white);
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    z-index: 2;
}

.featured-product-info {
    padding: 20px;
}

.featured-product-name {
    font-size: 17px;
    font-weight: 700;
    color: var(--stone-dark);
    margin-bottom: 8px;
    font-family: 'Roboto Slab', serif;
    line-height: 1.3;
}

.featured-product-price {
    font-size: 20px;
    font-weight: 800;
    color: var(--primary-gold);
    margin-bottom: 15px;
    font-family: 'Roboto Slab', serif;
}

.featured-product-actions {
    display: flex;
    gap: 10px;
}

.featured-action-btn {
    flex: 1;
    padding: 12px 15px;
    border-radius: var(--border-radius);
    border: none;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.featured-action-btn.primary {
    background: linear-gradient(135deg, var(--primary-gold), var(--gold-dark));
    color: var(--white);
}

.featured-action-btn.primary:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(201, 162, 39, 0.3);
}

.featured-action-btn.secondary {
    background: var(--bg-light);
    color: var(--stone-dark);
    border: 2px solid #e8e8e8;
}

.featured-action-btn.secondary:hover {
    background: var(--stone-dark);
    color: var(--white);
    border-color: var(--stone-dark);
}

/* Testimonials */
.testimonials {
    background: var(--stone-dark);
    color: var(--white);
    border-radius: var(--border-radius-xl);
    margin: 0 20px 25px;
    padding: 30px 25px;
    position: relative;
    overflow: hidden;
}

.testimonials::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 200px;
    height: 200px;
    background: linear-gradient(135deg, var(--primary-gold), transparent);
    border-radius: 50%;
    transform: translate(50%, -50%);
    opacity: 0.1;
}

.testimonial-slider {
    display: flex;
    gap: 25px;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    padding-bottom: 10px;
    -webkit-overflow-scrolling: touch;
}

.testimonial-slider::-webkit-scrollbar {
    display: none;
}

.testimonial-slide {
    min-width: 100%;
    scroll-snap-align: start;
}

.testimonial-content {
    background: rgba(255, 255, 255, 0.05);
    border-radius: var(--border-radius-lg);
    padding: 25px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.testimonial-text {
    font-size: 16px;
    line-height: 1.6;
    margin-bottom: 20px;
    font-style: italic;
    color: rgba(255, 255, 255, 0.9);
}

.testimonial-author {
    display: flex;
    align-items: center;
    gap: 15px;
}

.testimonial-author-img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    overflow: hidden;
    border: 3px solid var(--primary-gold);
}

.testimonial-author-img img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.testimonial-author-info h4 {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 5px;
}

.testimonial-author-info p {
    font-size: 14px;
    color: var(--gold-light);
    opacity: 0.8;
}

/* Newsletter */
.newsletter {
    background: linear-gradient(135deg, var(--primary-gold), var(--gold-dark));
    border-radius: var(--border-radius-xl);
    margin: 0 20px 25px;
    padding: 30px 25px;
    text-align: center;
    color: var(--white);
    position: relative;
    overflow: hidden;
}

.newsletter::before {
    content: '';
    position: absolute;
    bottom: -50px;
    right: -50px;
    width: 150px;
    height: 150px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
}

.newsletter h3 {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 10px;
    font-family: 'Roboto Slab', serif;
}

.newsletter p {
    font-size: 15px;
    opacity: 0.9;
    margin-bottom: 25px;
}

.newsletter-form {
    display: flex;
    gap: 10px;
    max-width: 400px;
    margin: 0 auto;
}

.newsletter-form input {
    flex: 1;
    padding: 16px 20px;
    border-radius: var(--border-radius-xl);
    border: none;
    font-size: 15px;
    background: rgba(255, 255, 255, 0.95);
    color: var(--stone-dark);
    transition: var(--transition);
}

.newsletter-form input:focus {
    outline: none;
    background: var(--white);
    box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.3);
}

.newsletter-form button {
    padding: 16px 25px;
    border-radius: var(--border-radius-xl);
    border: none;
    background: var(--stone-dark);
    color: var(--white);
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    white-space: nowrap;
}

.newsletter-form button:hover {
    background: #000;
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
}

/* Footer */
.site-footer {
    background: var(--stone-dark);
    color: var(--white);
    padding: 40px 20px 100px;
    margin-top: 30px;
}

.footer-content {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 30px;
    margin-bottom: 30px;
}

.footer-section h4 {
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 20px;
    color: var(--gold-light);
    font-family: 'Roboto Slab', serif;
}

.footer-section ul {
    list-style: none;
}

.footer-section ul li {
    margin-bottom: 12px;
}

.footer-section ul li a {
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    font-size: 14px;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
}

.footer-section ul li a:hover {
    color: var(--gold-light);
    padding-left: 5px;
}

.footer-section ul li a i {
    font-size: 12px;
    color: var(--primary-gold);
}

.social-links {
    display: flex;
    gap: 15px;
    margin-top: 20px;
}

.social-link {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--white);
    font-size: 16px;
    text-decoration: none;
    transition: var(--transition);
}

.social-link:hover {
    background: var(--primary-gold);
    transform: translateY(-3px);
}

.footer-bottom {
    text-align: center;
    padding-top: 30px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.6);
    font-size: 13px;
}

.payment-methods {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 20px;
}

.payment-method {
    width: 40px;
    height: 25px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--white);
    font-size: 12px;
}

/* Bottom Navigation - App Style */
.bottom-nav {
    position: fixed;
    left: 50%;
    bottom: 20px;
    transform: translateX(-50%);
    background: var(--white);
    display: flex;
    border-radius: var(--border-radius-xl);
    box-shadow: 0 -5px 25px rgba(0,0,0,0.15);
    z-index: 1000;
    width: calc(100% - 40px);
    max-width: 400px;
    padding: 10px;
    border: 1px solid rgba(0,0,0,0.05);
}

.nav-item {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 10px 5px;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: var(--transition);
    text-decoration: none;
    color: var(--text-light);
    position: relative;
    min-height: 60px;
}

.nav-item.active {
    color: var(--primary-gold);
    background: linear-gradient(135deg, rgba(201, 162, 39, 0.1), transparent);
}

.nav-item.active .nav-icon {
    transform: translateY(-5px);
}

.nav-icon {
    font-size: 20px;
    margin-bottom: 5px;
    transition: var(--transition);
}

.nav-text {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.5px;
}

.nav-indicator {
    position: absolute;
    top: -10px;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--primary-gold);
    opacity: 0;
    transition: var(--transition);
}

.nav-item.active .nav-indicator {
    opacity: 1;
}

/* Floating Action Button */
.fab {
    position: fixed;
    right: 20px;
    bottom: 90px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-gold), var(--gold-dark));
    color: var(--white);
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    cursor: pointer;
    box-shadow: 0 6px 20px rgba(201, 162, 39, 0.4);
    z-index: 1001;
    transition: var(--transition);
}

.fab:hover {
    transform: scale(1.1) rotate(90deg);
    box-shadow: 0 10px 30px rgba(201, 162, 39, 0.6);
}

/* Loading Spinner */
.loading-spinner {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 60px;
    height: 60px;
    border: 4px solid rgba(201, 162, 39, 0.1);
    border-radius: 50%;
    border-top-color: var(--primary-gold);
    animation: spin 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
    z-index: 9999;
}

@keyframes spin {
    to { transform: translate(-50%, -50%) rotate(360deg); }
}

/* Notification */
.notification {
    position: fixed;
    top: 100px;
    right: 20px;
    background: var(--stone-dark);
    color: white;
    padding: 18px 24px;
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-lg);
    z-index: 9999;
    transform: translateX(150%);
    transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    max-width: 300px;
    display: none;
    border-left: 5px solid var(--primary-gold);
}

.notification.show {
    transform: translateX(0);
    display: block;
}

/* Modal */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.9);
    z-index: 9998;
    align-items: center;
    justify-content: center;
    padding: 20px;
    overflow-y: auto;
}

.modal.active {
    display: flex;
}

.modal-content {
    background: var(--white);
    border-radius: var(--border-radius-xl);
    max-width: 400px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
    animation: modalSlideUp 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes modalSlideUp {
    from { opacity: 0; transform: translateY(50px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Responsive */
@media (max-width: 480px) {
    .app-container {
        border-radius: 0;
    }
    
    .hero h1 {
        font-size: 32px;
    }
    
    .hero p {
        font-size: 15px;
    }
    
    .hero-btn {
        min-width: 140px;
        padding: 14px 20px;
    }
    
    .quick-actions {
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
    }
    
    .quick-action {
        padding: 12px 8px;
    }
    
    .quick-action-icon {
        width: 45px;
        height: 45px;
        font-size: 18px;
    }
    
    .categories-grid,
    .uses-grid {
        grid-template-columns: 1fr;
    }
    
    .featured-slide {
        min-width: 260px;
    }
    
    .newsletter-form {
        flex-direction: column;
    }
    
    .newsletter-form input,
    .newsletter-form button {
        width: 100%;
    }
    
    .footer-content {
        grid-template-columns: 1fr;
        gap: 25px;
    }
}

@media (max-width: 360px) {
    .quick-actions {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .hero-buttons {
        flex-direction: column;
        align-items: center;
    }
    
    .hero-btn {
        width: 100%;
    }
}

/* Custom Scrollbar */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-light);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb {
    background: var(--primary-gold);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--gold-dark);
}
</style>
</head>

<body>

<!-- App Container -->
<div class="app-container">

<!-- Loading Spinner -->
<div class="loading-spinner" id="loadingSpinner"></div>

<!-- Notification -->
<div class="notification" id="notification"></div>

<!-- Smart Search Container -->
<div class="search-container" id="searchContainer">
    <div class="smart-search-box">
        <div class="search-input-container">
            <input type="text" placeholder="Search sandstone, kota stone, granite..." id="searchInput">
            <i class="fas fa-search search-icon"></i>
        </div>
        <button class="search-close" id="searchCloseBtn">
            <i class="fas fa-times"></i>
        </button>
    </div>
    <div class="search-results" id="searchResults">
        <!-- Search results will appear here -->
    </div>
</div>

<!-- Header -->
<header id="mainHeader">
    <div class="logo">
        <div class="logo-icon">
            <i class="fa-solid fa-gem"></i>
        </div>
        <div class="logo-text">
            <span class="brand">IRYA STONE</span>
            <span class="tagline">Premium Natural Stones</span>
        </div>
    </div>

    <!-- Header Actions -->
    <div class="header-actions">
        <button class="action-btn" id="searchBtn" title="Search">
            <i class="fas fa-search"></i>
        </button>
        <button class="action-btn" id="wishlistBtn" title="Wishlist">
            <i class="far fa-heart"></i>
        </button>
        <a href="cart.html" class="action-btn" title="Cart">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-badge" id="cartBadge">0</span>
        </a>
        <button class="action-btn" id="userBtn" title="Account">
            <i class="fas fa-user"></i>
        </button>
    </div>
</header>

<!-- Hero Section -->
<section class="hero" id="heroSection">
    <div class="hero-content">
        <h1>Premium Natural Stones</h1>
        <p>Export Quality Sandstone & Kota Stone from Indian quarries to UK homes</p>
        <div class="hero-buttons">
            <a href="#products" class="hero-btn primary">
                <i class="fas fa-gem"></i> Shop Now
            </a>
            <a href="#uses" class="hero-btn secondary">
                <i class="fas fa-info-circle"></i> Learn More
            </a>
        </div>
    </div>
</section>

<!-- Quick Actions -->
<div class="quick-actions">
    <a href="products.html?category=Sand%20Stone" class="quick-action">
        <div class="quick-action-icon">
            <i class="fas fa-layer-group"></i>
        </div>
        <span>Sand Stone</span>
    </a>
    <a href="products.html?category=Kota%20Stone" class="quick-action">
        <div class="quick-action-icon">
            <i class="fas fa-border-all"></i>
        </div>
        <span>Kota Stone</span>
    </a>
    <a href="categories.html" class="quick-action">
        <div class="quick-action-icon">
            <i class="fas fa-th-large"></i>
        </div>
        <span>All Categories</span>
    </a>
    <a href="deals.html" class="quick-action">
        <div class="quick-action-icon">
            <i class="fas fa-tag"></i>
        </div>
        <span>Special Deals</span>
    </a>
</div>

<!-- Categories Section -->
<section class="section" id="categories">
    <div class="section-header">
        <h2>Shop by Category</h2>
        <a href="categories.html" class="view-all">
            View All <i class="fas fa-arrow-right"></i>
        </a>
    </div>
    <div class="categories-grid" id="categoriesGrid">
        <!-- Categories will be loaded here -->
    </div>
</section>

<!-- Featured Products -->
<section class="featured-products">
    <div class="section-header">
        <h2>Featured Products</h2>
        <a href="products.html" class="view-all" style="color: white;">
            View All <i class="fas fa-arrow-right"></i>
        </a>
    </div>
    <div class="featured-slider" id="featuredSlider">
        <!-- Featured products will be loaded here -->
    </div>
</section>

<!-- Stone Uses Section -->
<section class="section" id="uses">
    <div class="section-header">
        <h2>Stone Applications</h2>
        <a href="applications.html" class="view-all">
            View All <i class="fas fa-arrow-right"></i>
        </a>
    </div>
    <div class="uses-grid" id="usesGrid">
        <!-- Uses will be loaded here -->
    </div>
</section>

<!-- Testimonials -->
<section class="testimonials">
    <div class="section-header" style="color: white;">
        <h2>Customer Reviews</h2>
        <a href="reviews.html" class="view-all" style="color: var(--gold-light);">
            View All <i class="fas fa-arrow-right"></i>
        </a>
    </div>
    <div class="testimonial-slider" id="testimonialSlider">
        <div class="testimonial-slide">
            <div class="testimonial-content">
                <p class="testimonial-text">"The quality of sandstone we received from IRYA STONE exceeded our expectations. Perfect for our garden landscaping project!"</p>
                <div class="testimonial-author">
                    <div class="testimonial-author-img">
                        <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Customer">
                    </div>
                    <div class="testimonial-author-info">
                        <h4>David Wilson</h4>
                        <p>Homeowner, London</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="testimonial-slide">
            <div class="testimonial-content">
                <p class="testimonial-text">"Excellent customer service and premium quality Kota Stone. Will definitely recommend to other contractors."</p>
                <div class="testimonial-author">
                    <div class="testimonial-author-img">
                        <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="Customer">
                    </div>
                    <div class="testimonial-author-info">
                        <h4>Sarah Johnson</h4>
                        <p>Interior Designer, Manchester</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Newsletter -->
<section class="newsletter">
    <h3>Stay Updated</h3>
    <p>Subscribe to get exclusive offers and stone care tips</p>
    <div class="newsletter-form">
        <input type="email" placeholder="Your email address" id="newsletterEmail">
        <button type="button" id="subscribeBtn">Subscribe</button>
    </div>
</section>

<!-- Footer -->
<footer class="site-footer">
    <div class="footer-content">
        <div class="footer-section">
            <h4>IRYA STONE</h4>
            <ul>
                <li><a href="about.html"><i class="fas fa-chevron-right"></i> About Us</a></li>
                <li><a href="contact.html"><i class="fas fa-chevron-right"></i> Contact Us</a></li>
                <li><a href="showroom.html"><i class="fas fa-chevron-right"></i> Visit Showroom</a></li>
                <li><a href="careers.html"><i class="fas fa-chevron-right"></i> Careers</a></li>
            </ul>
        </div>
        <div class="footer-section">
            <h4>Customer Service</h4>
            <ul>
                <li><a href="shipping.html"><i class="fas fa-chevron-right"></i> Shipping & Delivery</a></li>
                <li><a href="returns.html"><i class="fas fa-chevron-right"></i> Returns & Refunds</a></li>
                <li><a href="warranty.html"><i class="fas fa-chevron-right"></i> Warranty</a></li>
                <li><a href="faq.html"><i class="fas fa-chevron-right"></i> FAQ</a></li>
            </ul>
        </div>
        <div class="footer-section">
            <h4>Products</h4>
            <ul>
                <li><a href="sandstone.html"><i class="fas fa-chevron-right"></i> Sand Stone</a></li>
                <li><a href="kotastone.html"><i class="fas fa-chevron-right"></i> Kota Stone</a></li>
                <li><a href="granite.html"><i class="fas fa-chevron-right"></i> Granite</a></li>
                <li><a href="marble.html"><i class="fas fa-chevron-right"></i> Marble</a></li>
            </ul>
        </div>
        <div class="footer-section">
            <h4>Connect</h4>
            <div class="social-links">
                <a href="https://facebook.com" class="social-link" target="_blank">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="https://instagram.com" class="social-link" target="_blank">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://twitter.com" class="social-link" target="_blank">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="https://pinterest.com" class="social-link" target="_blank">
                    <i class="fab fa-pinterest-p"></i>
                </a>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <p>&copy; 2023 IRYA STONE. All rights reserved.</p>
        <div class="payment-methods">
            <div class="payment-method">Visa</div>
            <div class="payment-method">MC</div>
            <div class="payment-method">PP</div>
            <div class="payment-method">AMEX</div>
        </div>
    </div>
</footer>

<!-- Bottom Navigation -->
<div class="bottom-nav">
    <a href="index.html" class="nav-item active">
        <div class="nav-indicator"></div>
        <i class="fas fa-home nav-icon"></i>
        <span class="nav-text">Home</span>
    </a>
    <a href="products.html" class="nav-item">
        <i class="fas fa-th-large nav-icon"></i>
        <span class="nav-text">Products</span>
    </a>
    <a href="search.html" class="nav-item" id="bottomSearchBtn">
        <i class="fas fa-search nav-icon"></i>
        <span class="nav-text">Search</span>
    </a>
    <a href="account.html" class="nav-item">
        <i class="fas fa-user nav-icon"></i>
        <span class="nav-text">Account</span>
    </a>
    <a href="cart.html" class="nav-item">
        <i class="fas fa-shopping-cart nav-icon"></i>
        <span class="nav-text">Cart</span>
    </a>
</div>

<!-- Floating Action Button -->
<button class="fab" id="fabBtn" title="Quick Actions">
    <i class="fas fa-plus"></i>
</button>

</div> <!-- End App Container -->

<!-- Modal for User Options -->
<div class="modal" id="userModal">
    <div class="modal-content">
        <div class="modal-header" style="padding: 25px; border-bottom: 1px solid #f0f0f0;">
            <h3 style="color: var(--stone-dark);">Account Options</h3>
            <button class="modal-close" id="userModalClose" style="position: absolute; right: 25px; top: 25px; background: none; border: none; font-size: 20px; color: var(--text-light); cursor: pointer;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body" style="padding: 20px;">
            <div class="user-options">
                <a href="signin.html" class="user-option" style="display: flex; align-items: center; padding: 15px; border-radius: var(--border-radius); background: var(--bg-light); margin-bottom: 10px; text-decoration: none; color: var(--text-dark);">
                    <i class="fas fa-sign-in-alt" style="margin-right: 15px; color: var(--primary-gold);"></i>
                    <div>
                        <div style="font-weight: 600;">Sign In</div>
                        <div style="font-size: 13px; color: var(--text-light);">Access your account</div>
                    </div>
                </a>
                <a href="register.html" class="user-option" style="display: flex; align-items: center; padding: 15px; border-radius: var(--border-radius); background: var(--bg-light); margin-bottom: 10px; text-decoration: none; color: var(--text-dark);">
                    <i class="fas fa-user-plus" style="margin-right: 15px; color: var(--primary-gold);"></i>
                    <div>
                        <div style="font-weight: 600;">Register</div>
                        <div style="font-size: 13px; color: var(--text-light);">Create new account</div>
                    </div>
                </a>
                <a href="admin-login.html" class="user-option" style="display: flex; align-items: center; padding: 15px; border-radius: var(--border-radius); background: var(--bg-light); margin-bottom: 10px; text-decoration: none; color: var(--text-dark);">
                    <i class="fas fa-lock" style="margin-right: 15px; color: var(--primary-gold);"></i>
                    <div>
                        <div style="font-weight: 600;">Admin Login</div>
                        <div style="font-size: 13px; color: var(--text-light);">Administrator access</div>
                    </div>
                </a>
            </div>
        </div>
    </div>
</div>

<script>
// ============================================
// FIREBASE CONFIGURATION (Same as before)
// ============================================

const firebaseConfig = {
    apiKey: "AIzaSyDNwzhOkQQLAQbkiNFTFEGSpWJdKaxbTRk",
    authDomain: "iryastone-uk.firebaseapp.com",
    projectId: "iryastone-uk",
    storageBucket: "iryastone-uk.firebasestorage.app",
    messagingSenderId: "110940910896",
    appId: "1:110940910896:web:b25e92127118665e5c84f5",
    measurementId: "G-6YM1FLYN48"
};

// Firebase variables
let firebaseApp, firebaseDB, firebaseAuth;
let allProducts = [];
let featuredProducts = [];
let cartSystem = null;
let authSystem = null;
let wishlistSystem = null;

// ============================================
// AUTHENTICATION SYSTEM (Same as before - just included for completeness)
// ============================================

class AuthSystem {
    constructor() {
        this.currentUser = null;
        this.authKey = 'irya_stone_user';
    }
    
    async init() {
        this.checkLocalStorage();
        await this.checkFirebaseAuth();
        this.updateAuthUI();
    }
    
    async checkFirebaseAuth() {
        try {
            if (!firebaseAuth) return;
            
            firebaseAuth.onAuthStateChanged((user) => {
                if (user) {
                    this.currentUser = {
                        uid: user.uid,
                        displayName: user.displayName || 'User',
                        email: user.email,
                        photoURL: user.photoURL,
                        provider: user.providerId,
                        isFirebaseUser: true
                    };
                    
                    this.saveUserToLocalStorage();
                    
                    if (cartSystem) {
                        cartSystem.loadUserCart();
                    }
                } else {
                    this.currentUser = this.getUserFromLocalStorage();
                }
                
                this.updateAuthUI();
            });
        } catch (error) {
            console.error('Firebase auth error:', error);
            this.currentUser = this.getUserFromLocalStorage();
            this.updateAuthUI();
        }
    }
    
    checkLocalStorage() {
        const userData = localStorage.getItem(this.authKey);
        if (userData) {
            this.currentUser = JSON.parse(userData);
        }
    }
    
    saveUserToLocalStorage() {
        if (this.currentUser) {
            localStorage.setItem(this.authKey, JSON.stringify(this.currentUser));
        }
    }
    
    getUserFromLocalStorage() {
        const userData = localStorage.getItem(this.authKey);
        return userData ? JSON.parse(userData) : null;
    }
    
    isLoggedIn() {
        return this.currentUser !== null;
    }
    
    getUserId() {
        if (this.isLoggedIn()) {
            return this.currentUser.uid;
        }
        
        let guestId = localStorage.getItem('irya_guest_id');
        if (!guestId) {
            guestId = 'guest_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('irya_guest_id', guestId);
        }
        return guestId;
    }
    
    getUserName() {
        return this.currentUser ? this.currentUser.displayName : 'Guest';
    }
    
    getUserEmail() {
        return this.currentUser ? this.currentUser.email : '';
    }
    
    async logout() {
        try {
            if (this.currentUser && this.currentUser.isFirebaseUser && firebaseAuth) {
                await firebaseAuth.signOut();
            }
            
            this.currentUser = null;
            localStorage.removeItem(this.authKey);
            this.updateAuthUI();
            showNotification('Logged out successfully!');
            return true;
        } catch (error) {
            console.error('Logout error:', error);
            showError('Logout failed: ' + error.message);
            return false;
        }
    }
    
    updateAuthUI() {
        // In our new design, we show a modal instead of dropdown
    }
}

// ============================================
// CART SYSTEM (Same as before)
// ============================================

class CartSystem {
    constructor() {
        this.localCartKey = 'irya_local_cart_';
        this.cartItems = [];
    }
    
    async init() {
        await this.loadCart();
        this.updateCartBadge();
        return this;
    }
    
    getUserId() {
        return window.authSystem ? window.authSystem.getUserId() : 'guest';
    }
    
    async loadCart() {
        try {
            const userId = this.getUserId();
            
            if (window.authSystem && window.authSystem.isLoggedIn() && firebaseDB) {
                await this.loadFromFirebase(userId);
            } else {
                this.loadFromLocalStorage(userId);
            }
            
            return this.cartItems;
        } catch (error) {
            console.error('Error loading cart:', error);
            this.cartItems = [];
            return [];
        }
    }
    
    async loadFromFirebase(userId) {
        try {
            const cartDoc = await firebaseDB.collection('userCarts').doc(userId).get();
            
            if (cartDoc.exists) {
                this.cartItems = cartDoc.data().items || [];
                this.saveToLocalStorage(userId);
            } else {
                this.loadFromLocalStorage(userId);
                
                if (this.cartItems.length > 0) {
                    await this.saveToFirebase(userId);
                }
            }
        } catch (error) {
            console.error('Error loading cart from Firebase:', error);
            this.loadFromLocalStorage(userId);
        }
    }
    
    loadFromLocalStorage(userId) {
        const cartKey = this.localCartKey + userId;
        const cartData = localStorage.getItem(cartKey);
        this.cartItems = cartData ? JSON.parse(cartData) : [];
    }
    
    async saveCart() {
        const userId = this.getUserId();
        
        this.saveToLocalStorage(userId);
        
        if (window.authSystem && window.authSystem.isLoggedIn() && firebaseDB) {
            await this.saveToFirebase(userId);
        }
        
        this.updateCartBadge();
        return this.cartItems;
    }
    
    saveToLocalStorage(userId) {
        const cartKey = this.localCartKey + userId;
        localStorage.setItem(cartKey, JSON.stringify(this.cartItems));
    }
    
    async saveToFirebase(userId) {
        try {
            await firebaseDB.collection('userCarts').doc(userId).set({
                userId: userId,
                items: this.cartItems,
                updatedAt: new Date().toISOString(),
                itemCount: this.cartItems.reduce((sum, item) => sum + item.quantity, 0),
                totalAmount: this.cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0)
            }, { merge: true });
        } catch (error) {
            console.error('Error saving cart to Firebase:', error);
        }
    }
    
    async addToCart(product) {
        try {
            const existingItem = this.cartItems.find(item => item.id === product.id);
            
            if (existingItem) {
                existingItem.quantity += 1;
                existingItem.updatedAt = new Date().toISOString();
            } else {
                this.cartItems.push({
                    id: product.id,
                    name: product.stone_name || product.name,
                    stoneName: product.stone_name,
                    price: product.price,
                    priceUnit: product.price_unit || 'piece',
                    image: product.image,
                    category: product.category,
                    description: product.description,
                    quantity: 1,
                    addedAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    userId: this.getUserId()
                });
            }
            
            await this.saveCart();
            
            showNotification(`${product.stone_name} added to cart!`);
            
            // Animate cart button
            const cartBadge = document.getElementById('cartBadge');
            if (cartBadge) {
                cartBadge.style.transform = 'scale(1.5)';
                setTimeout(() => {
                    cartBadge.style.transform = 'scale(1)';
                }, 300);
            }
            
            return true;
        } catch (error) {
            console.error('Error adding to cart:', error);
            showError('Failed to add to cart. Please try again.');
            return false;
        }
    }
    
    getCartCount() {
        return this.cartItems.reduce((total, item) => total + item.quantity, 0);
    }
    
    updateCartBadge() {
        const count = this.getCartCount();
        const cartBadge = document.getElementById('cartBadge');
        if (cartBadge) {
            cartBadge.textContent = count;
            cartBadge.style.display = count > 0 ? 'flex' : 'none';
        }
    }
}

// ============================================
// WISHLIST SYSTEM (Same as before)
// ============================================

class WishlistSystem {
    constructor() {
        this.wishlistKey = 'irya_wishlist_';
        this.wishlistItems = [];
    }
    
    init() {
        this.loadWishlist();
        return this;
    }
    
    getUserId() {
        return window.authSystem ? window.authSystem.getUserId() : 'guest';
    }
    
    loadWishlist() {
        const userId = this.getUserId();
        const wishlistKey = this.wishlistKey + userId;
        const wishlistData = localStorage.getItem(wishlistKey);
        this.wishlistItems = wishlistData ? JSON.parse(wishlistData) : [];
        return this.wishlistItems;
    }
    
    saveWishlist() {
        const userId = this.getUserId();
        const wishlistKey = this.wishlistKey + userId;
        localStorage.setItem(wishlistKey, JSON.stringify(this.wishlistItems));
    }
    
    addToWishlist(product) {
        const existingItem = this.wishlistItems.find(item => item.id === product.id);
        
        if (!existingItem) {
            this.wishlistItems.push({
                id: product.id,
                stone_name: product.stone_name,
                category: product.category,
                price: product.price,
                price_unit: product.price_unit,
                image: product.image,
                addedAt: new Date().toISOString()
            });
            
            this.saveWishlist();
            showNotification(`${product.stone_name} added to wishlist!`);
            return true;
        }
        return false;
    }
    
    removeFromWishlist(productId) {
        const index = this.wishlistItems.findIndex(item => item.id === productId);
        
        if (index !== -1) {
            const productName = this.wishlistItems[index].stone_name;
            this.wishlistItems.splice(index, 1);
            this.saveWishlist();
            showNotification(`${productName} removed from wishlist`);
            return true;
        }
        return false;
    }
    
    isInWishlist(productId) {
        return this.wishlistItems.some(item => item.id === productId);
    }
    
    getWishlistCount() {
        return this.wishlistItems.length;
    }
}

// ============================================
// INITIALIZE FIREBASE
// ============================================

function initializeFirebase() {
    try {
        if (typeof firebase === 'undefined') {
            showError('Firebase not loaded. Please check your internet connection.');
            return false;
        }
        
        if (!firebase.apps.length) {
            firebaseApp = firebase.initializeApp(firebaseConfig);
        } else {
            firebaseApp = firebase.app();
        }
        
        firebaseDB = firebase.firestore();
        firebaseAuth = firebase.auth();
        
        console.log('Firebase initialized successfully');
        return true;
    } catch (error) {
        console.error('Firebase initialization error:', error);
        showError('Firebase initialization failed: ' + error.message);
        return false;
    }
}

// ============================================
// UI UTILITY FUNCTIONS
// ============================================

function showLoading(show) {
    const spinner = document.getElementById('loadingSpinner');
    if (spinner) {
        spinner.style.display = show ? 'block' : 'none';
    }
}

function showNotification(message) {
    const notification = document.getElementById('notification');
    if (!notification) return;
    
    notification.textContent = message;
    notification.classList.add('show');
    
    setTimeout(() => {
        notification.classList.remove('show');
    }, 3000);
}

function showError(message) {
    // We'll use notification for errors too
    showNotification(' ' + message);
}

// ============================================
// LOAD CATEGORIES (UPDATED FOR NEW DESIGN)
// ============================================

async function loadCategories() {
    const categoriesGrid = document.getElementById('categoriesGrid');
    if (!categoriesGrid) return;
    
    try {
        showLoading(true);
        
        if (!firebaseDB) {
            const initialized = initializeFirebase();
            if (!initialized) {
                loadDefaultCategories();
                return;
            }
        }
        
        const querySnapshot = await firebaseDB.collection("products").limit(50).get();
        
        if (!querySnapshot.empty) {
            const categoryMap = new Map();
            
            querySnapshot.forEach((doc) => {
                const data = doc.data();
                const category = data.category || 'Natural Stone';
                
                let image = data.image || '';
                if (!image && data.images && Array.isArray(data.images) && data.images.length > 0) {
                    image = data.images[0];
                }
                if (!image) {
                    image = getDefaultImage(category);
                }
                
                if (!categoryMap.has(category)) {
                    categoryMap.set(category, {
                        name: category,
                        image: image,
                        count: 1
                    });
                } else {
                    categoryMap.get(category).count += 1;
                }
            });
            
            // Get all categories sorted by count
            const allCategories = Array.from(categoryMap.values())
                .sort((a, b) => b.count - a.count);
            
            // Take first 3 categories for featured display
            const featuredCategories = allCategories.slice(0, 3);
            
            // Display categories
            let categoriesHTML = '';
            
            featuredCategories.forEach((category, index) => {
                const isFeatured = index === 0; // First category gets featured treatment
                
                categoriesHTML += `
                    <a href="products.html?category=${encodeURIComponent(category.name)}" 
                       class="category-card ${isFeatured ? 'featured' : ''}">
                        <div class="category-image">
                            <img src="${category.image}" alt="${category.name}"
                                 onerror="this.src='${getDefaultImage(category.name)}'"
                                 loading="lazy">
                            <div class="category-overlay">
                                <div class="category-name">${category.name}</div>
                                <div class="category-count">
                                    <i class="fas fa-box"></i> ${category.count} products
                                </div>
                            </div>
                        </div>
                    </a>
                `;
            });
            
            categoriesGrid.innerHTML = categoriesHTML;
        } else {
            loadDefaultCategories();
        }
        
    } catch (error) {
        console.error('Error loading categories:', error);
        loadDefaultCategories();
    } finally {
        showLoading(false);
    }
}

function loadDefaultCategories() {
    const categoriesGrid = document.getElementById('categoriesGrid');
    if (!categoriesGrid) return;
    
    const defaultCategories = [
        { name: 'Sand Stone', count: 25, image: 'https://images.unsplash.com/photo-1544931170-3ca1337cce88?auto=format&fit=crop&w=800', featured: true },
        { name: 'Kota Stone', count: 18, image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=800', featured: false },
        { name: 'Granite', count: 15, image: 'https://images.unsplash.com/photo-1581094794329-c8112a89af12?auto=format&fit=crop&w=800', featured: false }
    ];
    
    const categoriesHTML = defaultCategories.map(category => `
        <a href="products.html?category=${encodeURIComponent(category.name)}" 
           class="category-card ${category.featured ? 'featured' : ''}">
            <div class="category-image">
                <img src="${category.image}" alt="${category.name}">
                <div class="category-overlay">
                    <div class="category-name">${category.name}</div>
                    <div class="category-count">
                        <i class="fas fa-box"></i> ${category.count} products
                    </div>
                </div>
            </div>
        </a>
    `).join('');
    
    categoriesGrid.innerHTML = categoriesHTML;
}

// ============================================
// LOAD FEATURED PRODUCTS
// ============================================

async function loadFeaturedProducts() {
    const featuredSlider = document.getElementById('featuredSlider');
    if (!featuredSlider) return;
    
    try {
        if (!firebaseDB) {
            const initialized = initializeFirebase();
            if (!initialized) {
                loadDefaultFeaturedProducts();
                return;
            }
        }
        
        // Get 4 random featured products
        const querySnapshot = await firebaseDB.collection("products").limit(8).get();
        
        if (!querySnapshot.empty) {
            const products = [];
            querySnapshot.forEach((doc) => {
                const data = doc.data();
                
                const product = {
                    id: doc.id,
                    stone_name: data.stone_name || data.name || 'Stone Product',
                    category: data.category || '',
                    description: data.description || 'Premium quality natural stone.',
                    price: parseFloat(data.price) || 0,
                    price_unit: data.price_unit || 'piece',
                    usage: data.usage || data.uses || ''
                };
                
                if (data.images && Array.isArray(data.images) && data.images.length > 0) {
                    product.image = data.images[0];
                } else if (typeof data.image === 'string') {
                    product.image = data.image;
                } else {
                    product.image = getDefaultImage(product.category);
                }
                
                products.push(product);
            });
            
            // Shuffle and take 4 products
            const shuffled = products.sort(() => 0.5 - Math.random());
            featuredProducts = shuffled.slice(0, 4);
            
            displayFeaturedProducts(featuredProducts);
        } else {
            loadDefaultFeaturedProducts();
        }
        
    } catch (error) {
        console.error('Error loading featured products:', error);
        loadDefaultFeaturedProducts();
    }
}

function displayFeaturedProducts(products) {
    const featuredSlider = document.getElementById('featuredSlider');
    if (!featuredSlider) return;
    
    const productsHTML = products.map(product => {
        const formattedPrice = formatPrice(product.price, product.price_unit);
        
        return `
            <div class="featured-slide">
                <div class="featured-product-card">
                    <div class="featured-product-image">
                        <img src="${product.image}" alt="${product.stone_name}" 
                             onerror="this.src='${getDefaultImage(product.category)}'"
                             loading="lazy">
                        <div class="featured-product-badge">Featured</div>
                    </div>
                    <div class="featured-product-info">
                        <h3 class="featured-product-name">${product.stone_name}</h3>
                        <div class="featured-product-price">${formattedPrice}</div>
                        <div class="featured-product-actions">
                            <button class="featured-action-btn primary" 
                                    onclick="addToCart('${product.id}')">
                                <i class="fas fa-cart-plus"></i> Add to Cart
                            </button>
                            <button class="featured-action-btn secondary" 
                                    onclick="toggleWishlist('${product.id}')">
                                <i class="far fa-heart"></i> Wishlist
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }).join('');
    
    featuredSlider.innerHTML = productsHTML;
}

function loadDefaultFeaturedProducts() {
    const defaultProducts = [
        {
            id: '1',
            stone_name: 'Raj Green Sandstone',
            category: 'Sand Stone',
            description: 'Beautiful green sandstone with natural patterns.',
            price: 38.00,
            price_unit: 'sqft',
            image: 'https://images.unsplash.com/photo-1544931170-3ca1337cce88?auto=format&fit=crop&w=800'
        },
        {
            id: '2',
            stone_name: 'Kota Blue Stone',
            category: 'Kota Stone',
            description: 'Premium quality blue kota stone for flooring.',
            price: 42.50,
            price_unit: 'sqft',
            image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=800'
        }
    ];
    
    displayFeaturedProducts(defaultProducts);
}

// ============================================
// LOAD STONE USES
// ============================================

async function loadStoneUses() {
    const usesGrid = document.getElementById('usesGrid');
    if (!usesGrid) return;
    
    try {
        if (!firebaseDB) {
            const initialized = initializeFirebase();
            if (!initialized) {
                loadDefaultUses();
                return;
            }
        }
        
        const querySnapshot = await firebaseDB.collection("products").limit(50).get();
        
        if (!querySnapshot.empty) {
            const usesMap = new Map();
            
            querySnapshot.forEach((doc) => {
                const data = doc.data();
                const usage = data.usage || data.uses || 'General Use';
                
                let image = data.image || '';
                if (!image && data.images && Array.isArray(data.images) && data.images.length > 0) {
                    image = data.images[0];
                }
                if (!image) {
                    image = getDefaultUseImage(usage);
                }
                
                if (!usesMap.has(usage)) {
                    usesMap.set(usage, {
                        name: usage,
                        image: image,
                        count: 1
                    });
                } else {
                    usesMap.get(usage).count += 1;
                }
            });
            
            // Convert to array and sort by count
            const uses = Array.from(usesMap.values())
                .sort((a, b) => b.count - a.count)
                .slice(0, 4); // Show top 4 uses
            
            displayUses(uses);
        } else {
            loadDefaultUses();
        }
        
    } catch (error) {
        console.error('Error loading stone uses:', error);
        loadDefaultUses();
    }
}

function displayUses(uses) {
    const usesGrid = document.getElementById('usesGrid');
    if (!usesGrid) return;
    
    const usesHTML = uses.map(use => `
        <a href="products.html?usage=${encodeURIComponent(use.name)}" class="use-card">
            <div class="use-image">
                <img src="${use.image}" alt="${use.name}" 
                     onerror="this.src='${getDefaultUseImage(use.name)}'"
                     loading="lazy">
                <div class="use-overlay">
                    <div class="use-name">${use.name}</div>
                </div>
            </div>
        </a>
    `).join('');
    
    usesGrid.innerHTML = usesHTML;
}

function loadDefaultUses() {
    const defaultUses = [
        {
            name: 'Wall Cladding',
            image: 'https://images.unsplash.com/photo-1513584684374-8bab748fbf90?auto=format&fit=crop&w=800',
            count: 15
        },
        {
            name: 'Flooring',
            image: 'https://images.unsplash.com/photo-1565538810643-b5bdb714032a?auto=format&fit=crop&w=800',
            count: 20
        },
        {
            name: 'Garden Paving',
            image: 'https://images.unsplash.com/photo-1565538810643-b5bdb714032a?auto=format&fit=crop&w=800',
            count: 18
        },
        {
            name: 'Pool Surround',
            image: 'https://images.unsplash.com/photo-1575429198097-0414ec08e8cd?auto=format&fit=crop&w=800',
            count: 8
        }
    ];
    
    displayUses(defaultUses);
}

// ============================================
// HELPER FUNCTIONS
// ============================================

function getDefaultImage(category) {
    const categoryLower = (category || '').toLowerCase();
    
    if (categoryLower.includes('sand')) {
        return 'https://images.unsplash.com/photo-1544931170-3ca1337cce88?auto=format&fit=crop&w=800';
    } else if (categoryLower.includes('kota')) {
        return 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=800';
    } else if (categoryLower.includes('granite')) {
        return 'https://images.unsplash.com/photo-1581094794329-c8112a89af12?auto=format&fit=crop&w=800';
    } else if (categoryLower.includes('marble')) {
        return 'https://images.unsplash.com/photo-1581094794329-c8112a89af12?auto=format&fit=crop&w=800';
    }
    
    return 'https://images.unsplash.com/photo-1544931170-3ca1337cce88?auto=format&fit=crop&w=800';
}

function getDefaultUseImage(use) {
    const useLower = (use || '').toLowerCase();
    
    if (useLower.includes('wall') || useLower.includes('cladding')) {
        return 'https://images.unsplash.com/photo-1513584684374-8bab748fbf90?auto=format&fit=crop&w=800';
    } else if (useLower.includes('floor') || useLower.includes('paving') || useLower.includes('patio')) {
        return 'https://images.unsplash.com/photo-1565538810643-b5bdb714032a?auto=format&fit=crop&w=800';
    } else if (useLower.includes('kitchen') || useLower.includes('counter')) {
        return 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?auto=format&fit=crop&w=800';
    } else if (useLower.includes('pool')) {
        return 'https://images.unsplash.com/photo-1575429198097-0414ec08e8cd?auto=format&fit=crop&w=800';
    }
    
    return 'https://images.unsplash.com/photo-1544931170-3ca1337cce88?auto=format&fit=crop&w=800';
}

function formatPrice(price, unit = 'piece') {
    if (!price && price !== 0) return 'Price on request';
    
    const priceNum = typeof price === 'number' ? price : parseFloat(price);
    
    if (isNaN(priceNum)) return 'Price on request';
    
    if (unit === 'sqft' || unit === 'm') {
        return `${priceNum.toFixed(2)}/${unit}`;
    } else if (unit === 'piece') {
        return `${priceNum.toFixed(2)} per piece`;
    } else {
        return `${priceNum.toFixed(2)}`;
    }
}

// ============================================
// SEARCH FUNCTIONALITY
// ============================================

async function searchProducts(query) {
    if (!query || query.trim() === '') {
        hideSearchResults();
        return;
    }
    
    const searchResults = document.getElementById('searchResults');
    if (!searchResults) return;
    
    try {
        showLoading(true);
        
        if (!firebaseDB) {
            const initialized = initializeFirebase();
            if (!initialized) {
                showNoSearchResults();
                return;
            }
        }
        
        // Search in multiple fields
        const snapshot = await firebaseDB.collection("products")
            .where("keywords", "array-contains", query.toLowerCase())
            .limit(10)
            .get();
        
        let results = [];
        
        if (!snapshot.empty) {
            snapshot.forEach((doc) => {
                const data = doc.data();
                results.push({
                    id: doc.id,
                    stone_name: data.stone_name || data.name,
                    category: data.category,
                    price: data.price,
                    price_unit: data.price_unit,
                    usage: data.usage,
                    image: data.image || (data.images && data.images[0]) || getDefaultImage(data.category)
                });
            });
        }
        
        // If no results from keyword search, try text search
        if (results.length === 0) {
            const allSnapshot = await firebaseDB.collection("products").limit(20).get();
            
            allSnapshot.forEach((doc) => {
                const data = doc.data();
                const searchableText = (data.stone_name + ' ' + data.category + ' ' + data.description + ' ' + data.usage).toLowerCase();
                
                if (searchableText.includes(query.toLowerCase())) {
                    results.push({
                        id: doc.id,
                        stone_name: data.stone_name || data.name,
                        category: data.category,
                        price: data.price,
                        price_unit: data.price_unit,
                        usage: data.usage,
                        image: data.image || (data.images && data.images[0]) || getDefaultImage(data.category)
                    });
                }
            });
        }
        
        displaySearchResults(results, query);
        
    } catch (error) {
        console.error('Search error:', error);
        showNoSearchResults();
    } finally {
        showLoading(false);
    }
}

function displaySearchResults(results, query) {
    const searchResults = document.getElementById('searchResults');
    if (!searchResults) return;
    
    if (results.length === 0) {
        searchResults.innerHTML = `
            <div class="no-results">
                <i class="fas fa-search"></i>
                <h4>No results found for "${query}"</h4>
                <p>Try different keywords or browse categories</p>
            </div>
        `;
    } else {
        const resultsHTML = results.map(product => `
            <a href="product.html?id=${product.id}" class="search-result-item">
                <div class="search-result-image">
                    <img src="${product.image}" alt="${product.stone_name}"
                         onerror="this.src='${getDefaultImage(product.category)}'">
                </div>
                <div class="search-result-info">
                    <div class="search-result-name">${product.stone_name}</div>
                    <div class="search-result-meta">
                        <span class="search-result-category">${product.category}</span>
                        <span class="search-result-usage">${product.usage || 'General Use'}</span>
                    </div>
                    <div class="search-result-price">${formatPrice(product.price, product.price_unit)}</div>
                </div>
            </a>
        `).join('');
        
        searchResults.innerHTML = resultsHTML;
    }
    
    searchResults.classList.add('active');
}

function showNoSearchResults() {
    const searchResults = document.getElementById('searchResults');
    if (!searchResults) return;
    
    searchResults.innerHTML = `
        <div class="no-results">
            <i class="fas fa-search"></i>
            <h4>Search unavailable</h4>
            <p>Please check your connection and try again</p>
        </div>
    `;
    
    searchResults.classList.add('active');
}

function hideSearchResults() {
    const searchResults = document.getElementById('searchResults');
    if (searchResults) {
        searchResults.classList.remove('active');
    }
}

// ============================================
// EVENT LISTENERS AND INITIALIZATION
// ============================================

document.addEventListener('DOMContentLoaded', async function() {
    console.log('IRYA STONE Mobile App initialized');
    
    // Initialize Firebase
    initializeFirebase();
    
    // Initialize systems
    authSystem = new AuthSystem();
    await authSystem.init();
    
    cartSystem = new CartSystem();
    await cartSystem.init();
    
    wishlistSystem = new WishlistSystem();
    wishlistSystem.init();
    
    // Load content
    await Promise.all([
        loadCategories(),
        loadFeaturedProducts(),
        loadStoneUses()
    ]);
    
    // Search functionality
    const searchBtn = document.getElementById('searchBtn');
    const searchCloseBtn = document.getElementById('searchCloseBtn');
    const searchContainer = document.getElementById('searchContainer');
    const searchInput = document.getElementById('searchInput');
    const bottomSearchBtn = document.getElementById('bottomSearchBtn');
    
    if (searchBtn) {
        searchBtn.addEventListener('click', () => {
            searchContainer.classList.add('active');
            setTimeout(() => searchInput.focus(), 100);
        });
    }
    
    if (searchCloseBtn) {
        searchCloseBtn.addEventListener('click', () => {
            searchContainer.classList.remove('active');
            hideSearchResults();
        });
    }
    
    if (bottomSearchBtn) {
        bottomSearchBtn.addEventListener('click', (e) => {
            e.preventDefault();
            searchContainer.classList.add('active');
            setTimeout(() => searchInput.focus(), 100);
        });
    }
    
    // Search input handling
    let searchTimeout;
    if (searchInput) {
        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                searchProducts(this.value);
            }, 300);
        });
        
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchProducts(this.value);
            }
        });
    }
    
    // User modal
    const userBtn = document.getElementById('userBtn');
    const userModal = document.getElementById('userModal');
    const userModalClose = document.getElementById('userModalClose');
    
    if (userBtn && userModal) {
        userBtn.addEventListener('click', () => {
            userModal.classList.add('active');
        });
        
        userModalClose.addEventListener('click', () => {
            userModal.classList.remove('active');
        });
        
        userModal.addEventListener('click', (e) => {
            if (e.target === userModal) {
                userModal.classList.remove('active');
            }
        });
    }
    
    // Wishlist button
    const wishlistBtn = document.getElementById('wishlistBtn');
    if (wishlistBtn) {
        wishlistBtn.addEventListener('click', () => {
            window.location.href = 'wishlist.html';
        });
    }
    
    // FAB button
    const fabBtn = document.getElementById('fabBtn');
    if (fabBtn) {
        fabBtn.addEventListener('click', () => {
            // Show quick actions modal or scroll to top
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    }
    
    // Newsletter subscription
    const subscribeBtn = document.getElementById('subscribeBtn');
    const newsletterEmail = document.getElementById('newsletterEmail');
    
    if (subscribeBtn && newsletterEmail) {
        subscribeBtn.addEventListener('click', () => {
            const email = newsletterEmail.value.trim();
            
            if (!email) {
                showNotification('Please enter your email address');
                newsletterEmail.focus();
                return;
            }
            
            if (!validateEmail(email)) {
                showNotification('Please enter a valid email address');
                newsletterEmail.focus();
                return;
            }
            
            // Save to localStorage
            localStorage.setItem('newsletter_subscription', email);
            
            // Show success message
            showNotification('Thank you for subscribing!');
            newsletterEmail.value = '';
            
            // Here you would typically send to a server
            console.log('Newsletter subscription:', email);
        });
    }
    
    // Make functions globally available
    window.addToCart = async function(productId) {
        const product = featuredProducts.find(p => p.id === productId);
        if (product && cartSystem) {
            await cartSystem.addToCart(product);
        }
    };
    
    window.toggleWishlist = function(productId) {
        const product = featuredProducts.find(p => p.id === productId);
        if (!product) return;
        
        if (wishlistSystem.isInWishlist(productId)) {
            wishlistSystem.removeFromWishlist(productId);
            showNotification('Removed from wishlist');
        } else {
            wishlistSystem.addToWishlist(product);
            showNotification('Added to wishlist');
        }
    };
    
    // Initialize systems globally
    window.authSystem = authSystem;
    window.cartSystem = cartSystem;
    window.wishlistSystem = wishlistSystem;
});

// Email validation helper
function validateEmail(email) {
    const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
}

// Scroll handling for header
let lastScrollTop = 0;
const header = document.getElementById('mainHeader');

window.addEventListener('scroll', function() {
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    if (scrollTop > lastScrollTop && scrollTop > 100) {
        header.classList.add('hidden');
    } else {
        header.classList.remove('hidden');
    }
    
    lastScrollTop = scrollTop;
});
</script>
</body>
</html>
